<div class="d-flex justify-content-center position-relative">
  <div class="bg-[#003366] text-white py-4 mb-4">
    <div class="containerr mx-auto text-center">
      <!-- <h2 class="text-3xl font-bold tracking-wide mb-2">SEGURIDAD E HIGIENE</h2> -->
      <h3 class="text-xl">CÁLCULO DE INDICADORES</h3>
    </div>

    <div class="container">
      <form [formGroup]="form" (ngSubmit)="continuar()">
        <div class="form-section">
          <!-- SECCION, DATOS INICIALES -->
          <div class="indicators-section">
            <div class="card-header text-white">
              <div class="header-container">
                <i class="bi bi-info-square-fill fs-1 justify-self-end"></i><h4>INGRESA TUS DATOS INICIALES</h4>
              </div>
            </div>

            <div class="indicator-group" formGroupName="indiceFrecuencia">
              <!-- <div class="indicator-label">Índice de Frecuencia (IF)</div> -->
               <div class="datosIniciales_Principal">
              <div class="formula-container">
                <div class="fraction">
                  <div class="denominator">
                    <div class="denominator__inputs">
                      <!-- Contenedor datosEntrada -->
                      <div class="datosEntrada">
                        <!-- Campo TOTAL TRABAJADORES -->
                        <div class="form-group position-relative">
                          <label for="totalTrabajadores"
                                 [class.float-label]="shouldFloatLabel('indiceFrecuencia.totalTrabajadores')">
                            TOTAL TRABAJADORES
                          </label>
                          <input
                            id="totalTrabajadores"
                            type="number"
                            formControlName="totalTrabajadores"
                            (input)="onInputChange('totalTrabajadores', $any($event.target).value)"
                            (focus)="onFocus('indiceFrecuencia.totalTrabajadores')"
                            (blur)="onBlur('indiceFrecuencia.totalTrabajadores')"
                          >
                        </div>

                          <!-- Campo para TOTAL HORAS TRABAJADAS -->
                          <div class="form-group position-relative">
                            <label for="totalHorasTrabajadas"
                                   [class.float-label]="shouldFloatLabel('indiceFrecuencia.totalHorasTrabajadas')">
                              TOTAL HORAS TRABAJADAS/MES
                            </label>
                            <input
                              id="totalHorasTrabajadas"
                              type="number"
                              formControlName="totalHorasTrabajadas"
                              (input)="onInputChange('totalHorasTrabajadas', $any($event.target).value)"
                              (focus)="onFocus('indiceFrecuencia.totalHorasTrabajadas')"
                              (blur)="onBlur('indiceFrecuencia.totalHorasTrabajadas')"
                            >
                          </div>
                        </div>
                      </div>
                  </div>
                </div>
              </div>
            </div>
            </div>
          </div>

          <!-- SECCION, INDICADORES REACTIVOS -->
          <div class="indicators-section">
            <div class="card-header text-white">
              <div class="header-container">
                <i class="bi-exclamation-triangle-fill fs-1 justify-self-end"></i><h4>INDICADORES REACTIVOS</h4>
              </div>
            </div>

            <div class="indicator-group" formGroupName="indiceFrecuencia">
              <div class="indicator-label">Índice de Frecuencia (IF)</div>
              <div class="formula-container">
                <div class="fraction">

                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="numerador" [class.float-label]="shouldFloatLabel('indiceFrecuencia.numerador')">
                        NUMERO DE LESIONES
                      </label>
                      <input
                        id="numerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('indiceFrecuencia.numerador')"
                        (blur)="onBlur('indiceFrecuencia.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <!-- Denominador (3 campos) -->
                  <div class="demoniadorPrincipal">
                    <div class="denominadorCampos">
                      <!-- <div class="denominator"> -->
                        <!-- TOTAL TRABAJADORES -->
                        <div class="campoOne" >
                            <div class="form-group position-relative">
                              <label for="ifDenominadorTotal" [class.float-label]="shouldFloatLabel('indiceFrecuencia.denominador_total')">
                                TOTAL TRABAJADORES
                              </label>
                              <input
                                id="ifDenominadorTotal"
                                type="number"
                                formControlName="denominador_total"
                                placeholder=""
                                (focus)="onFocus('indiceFrecuencia.denominador_total')"
                                (blur)="onBlur('indiceFrecuencia.denominador_total')"
                                [disabled]="true"
                              >
                            </div>
                          </div>
                          <!-- <div class="multiply">x</div> -->


                        <!-- HORAS TRABAJADAS -->
                        <div class="campoTwo">
                            <div class="form-group position-relative">
                              <label class="label_2" for="ifDenominadorHoras" [class.float-label]="shouldFloatLabel('indiceFrecuencia.denominador_horas')">
                                HORAS TRABAJADAS
                              </label>
                              <input
                                id="ifDenominadorHoras"
                                type="number"
                                formControlName="denominador_horas"
                                placeholder=""
                                (focus)="onFocus('indiceFrecuencia.denominador_horas')"
                                (blur)="onBlur('indiceFrecuencia.denominador_horas')"
                                [disabled]="true"
                              >
                            </div>
                        </div>
                        <!-- <div class="multiply">x</div> -->

                                    <!-- DÍAS TRABAJADOS -->
                        <div class="campoThree">
                            <div class="form-group position-relative">
                              <label class="label_3" for="ifDenominadorDias" [class.float-label]="shouldFloatLabel('indiceFrecuencia.denominador_dias')">
                                DÍAS TRABAJADOS
                              </label>
                              <input
                                id="ifDenominadorDias"
                                type="number"
                                formControlName="denominador_dias"
                                placeholder=""
                                (focus)="onFocus('indiceFrecuencia.denominador_dias')"
                                (blur)="onBlur('indiceFrecuencia.denominador_dias')"
                                min="1"
                              >
                            </div>
                        </div>
                      <!-- </div> -->
                    </div>
                  </div>
                </div>
                <!-- <div class="multiply">x</div> -->
                <!-- <div class="constant">100</div> -->
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('indiceFrecuencia')?.get('resultado')?.value || 0}}</div>
                </div>
              </div>
              <div class="indicator-group__mensaje">
                <p class="mensaje-texto">{{ mensaje['indiceFrecuencia'] }}</p>
              </div>
            </div>

            <div class="indicator-group" formGroupName="indiceGravedad">
              <div class="indicator-label">Índice de Gravedad (IG)</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="igNumerador" [class.float-label]="shouldFloatLabel('indiceGravedad.numerador')">
                        DÍAS PERDIDOS
                      </label>
                      <input
                        id="igNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('indiceGravedad.numerador')"
                        (blur)="onBlur('indiceGravedad.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="igDenominador" [class.float-label]="shouldFloatLabel('indiceGravedad.denominador')">
                        HORAS TRABAJADAS
                      </label>
                      <input
                        id="igDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('indiceGravedad.denominador')"
                        (blur)="onBlur('indiceGravedad.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('indiceGravedad')?.get('resultado')?.value || 0}}</div>
                </div>
              </div>
              <div class="indicator-group__mensaje">
                <p class="mensaje-texto">{{ mensaje['indiceGravedad'] }}</p>
              </div>
            </div>

            <div class="indicator-group" formGroupName="tasaRiesgo">
              <div class="indicator-label">Tasa de Riesgo (TR)</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="trNumerador" [class.float-label]="shouldFloatLabel('tasaRiesgo.numerador')">
                        DÍAS PERDIDOS (IG)
                      </label>
                      <input
                        id="trNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        readonly
                        (focus)="onFocus('tasaRiesgo.numerador')"
                        (blur)="onBlur('tasaRiesgo.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="trDenominador" [class.float-label]="shouldFloatLabel('tasaRiesgo.denominador')">
                        LESIONES (IF)
                      </label>
                      <input
                        id="trDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        readonly
                        (focus)="onFocus('tasaRiesgo.denominador')"
                        (blur)="onBlur('tasaRiesgo.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('tasaRiesgo')?.get('resultado')?.value || 0}}</div>
                </div>
              </div>
            </div>
          </div>

          <!-- SECCION, INDICADORES PROACTIVOS -->
          <div class="indicators-section">
            <div class="card-header text-white">
              <div class="header-container">
                <i class="bi-bandaid-fill fs-1"></i><h4>INDICADORES PROACTIVOS</h4>
              </div>
            </div>

            <div class="indicator-group" formGroupName="capacitacionesSeguridad">
              <div class="indicator-label">Capacitaciones de Seguridad</div>
                <div class="formula-container">
                  <div class="fraction">
                    <!-- Numerador -->
                    <div class="numerator">
                      <div class="form-group position-relative">
                        <label for="capNumerador" [class.float-label]="shouldFloatLabel('capacitacionesSeguridad.numerador')">
                          TRABAJADORES CAPACITADOS
                        </label>
                        <input
                          id="capNumerador"
                          type="number"
                          formControlName="numerador"
                          placeholder=""
                          (focus)="onFocus('capacitacionesSeguridad.numerador')"
                          (blur)="onBlur('capacitacionesSeguridad.numerador')"
                        >
                      </div>
                    </div>
                  <div class="division-line"></div>
                  <!-- Denominador -->
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="capDenominador" [class.float-label]="shouldFloatLabel('capacitacionesSeguridad.denominador')">
                        TOTAL TRABAJADORES
                      </label>
                      <input
                        id="capDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('capacitacionesSeguridad.denominador')"
                        (blur)="onBlur('capacitacionesSeguridad.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="multiply">×</div>
                <div class="result-value-p">
                 <div class="constant">100</div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('capacitacionesSeguridad')?.get('resultado')?.value || 0}}%</div>
                </div>

              </div>
            </div>

            <div class="indicator-group" formGroupName="inspeccionesSeguridad">
              <div class="indicator-label">Inspecciones de Seguridad</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="insNumerador" [class.float-label]="shouldFloatLabel('inspeccionesSeguridad.numerador')">
                        INSPECCIONES REALIZADAS
                      </label>
                      <input
                        id="insNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('inspeccionesSeguridad.numerador')"
                        (blur)="onBlur('inspeccionesSeguridad.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="insDenominador" [class.float-label]="shouldFloatLabel('inspeccionesSeguridad.denominador')">
                        INSPECCIONES PLANEADAS
                      </label>
                      <input
                        id="insDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('inspeccionesSeguridad.denominador')"
                        (blur)="onBlur('inspeccionesSeguridad.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="multiply">×</div>
                <div class="result-value-p">
                  <div class="constant">100</div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('inspeccionesSeguridad')?.get('resultado')?.value || 0}}%</div>
                </div>
              </div>
            </div>

            <div class="indicator-group" formGroupName="observacionesCSeguros">
              <div class="indicator-label">Observaciones de C.Seguros</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="obsNumerador" [class.float-label]="shouldFloatLabel('observacionesCSeguros.numerador')">
                        COMPORTAMIENTOS SEGUROS
                      </label>
                      <input
                        id="obsNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('observacionesCSeguros.numerador')"
                        (blur)="onBlur('observacionesCSeguros.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="obsDenominador" [class.float-label]="shouldFloatLabel('observacionesCSeguros.denominador')">
                        TOTAL OBSERVACIONES
                      </label>
                      <input
                        id="obsDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('observacionesCSeguros.denominador')"
                        (blur)="onBlur('observacionesCSeguros.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="multiply">×</div>
                <div class="result-value-p">
                  <div class="constant">100</div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('observacionesCSeguros')?.get('resultado')?.value || 0}}%</div>
                </div>
              </div>
            </div>

            <div class="indicator-group" formGroupName="correcionConInseguras">
              <div class="indicator-label">Correción de C.Inseguras</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="corrNumerador" [class.float-label]="shouldFloatLabel('correcionConInseguras.numerador')">
                        CONDICIONES CORREGIDAS
                      </label>
                      <input
                        id="corrNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('correcionConInseguras.numerador')"
                        (blur)="onBlur('correcionConInseguras.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="corrDenominador" [class.float-label]="shouldFloatLabel('correcionConInseguras.denominador')">
                        CONDICIONES DETECTADAS
                      </label>
                      <input
                        id="corrDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('correcionConInseguras.denominador')"
                        (blur)="onBlur('correcionConInseguras.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="multiply">×</div>
                <div class="result-value-p">
                  <div class="constant">100</div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('correcionConInseguras')?.get('resultado')?.value || 0}}%</div>
                </div>
              </div>
            </div>

            <!-- Cumplimiento del Uso de EPP -->
            <div class="indicator-group" formGroupName="cumplimientoUsoEPP">
              <div class="indicator-label">Cumplimiento del Uso de EPP</div>
              <div class="formula-container">
                <div class="fraction">
                  <div class="numerator">
                    <div class="form-group position-relative">
                      <label for="eppNumerador" [class.float-label]="shouldFloatLabel('cumplimientoUsoEPP.numerador')">
                        USO CORRECTO EPP
                      </label>
                      <input
                        id="eppNumerador"
                        type="number"
                        formControlName="numerador"
                        placeholder=""
                        (focus)="onFocus('cumplimientoUsoEPP.numerador')"
                        (blur)="onBlur('cumplimientoUsoEPP.numerador')"
                      >
                    </div>
                  </div>
                  <div class="division-line"></div>
                  <div class="denominator">
                    <div class="form-group position-relative">
                      <label for="eppDenominador" [class.float-label]="shouldFloatLabel('cumplimientoUsoEPP.denominador')">
                        TOTAL OBSERVADOS
                      </label>
                      <input
                        id="eppDenominador"
                        type="number"
                        formControlName="denominador"
                        placeholder=""
                        (focus)="onFocus('cumplimientoUsoEPP.denominador')"
                        (blur)="onBlur('cumplimientoUsoEPP.denominador')"
                      >
                    </div>
                  </div>
                </div>
                <div class="multiply">×</div>
                <div class="result-value-p">
                  <div class="constant">100</div>
                </div>
                <div class="result">=</div>
                <div class="result-value-p">
                  <div class="result-value">{{form.get('cumplimientoUsoEPP')?.get('resultado')?.value || 0}}%</div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="row mt-3">
          <div class="col-12 d-flex justify-content-between">
            <button type="button" class="btn btn-outline-primary" (click)="regresar()">
              <i class="bi bi-arrow-left me-2"></i>REGRESAR
            </button>
            <button type="button" class="btn btn-primary" [disabled]="!form.valid" (click)="continuar()">
              SIGUIENTE<i class="bi bi-arrow-right ms-2"></i>
            </button>
          </div>
        </div>
      </form>
    </div>
  </div>
</div>
